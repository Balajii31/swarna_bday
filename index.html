<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Birthday Scrapbook Surprise</title>
  <style>
    :root {
      --pink: #ff9ac8;
      --lavender: #c9a7ff;
      --mint: #a9f5d0;
      --soft-yellow: #fff2b2;
      --sky: #b5e3ff;
      --deep-purple: #8b6bff;
      --soft-shadow: 0 20px 45px rgba(123, 71, 179, 0.25);
      --card-radius: 22px;
      --gradient: linear-gradient(135deg, rgba(255, 154, 200, 0.85), rgba(181, 227, 255, 0.9));
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #fff7fb 0%, #eef7ff 40%, #ffeef8 100%);
      color: #4c2b57;
      overflow-x: hidden;
    }

    /* Multi-page system */
    .page {
      display: none;
      min-height: 100vh;
      padding-top: 80px;
      opacity: 0;
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      transform: translateY(20px);
    }

    .page.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    .page-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .confetti-splash {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 5;
    }

    canvas#celebrationCanvas {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 999;
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .stars-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 2;
      overflow: hidden;
    }

    .star {
      position: absolute;
      color: rgba(255, 255, 255, 0.8);
      font-size: 1.5rem;
      animation: twinkle 3s ease-in-out infinite;
      text-shadow: 0 0 10px rgba(255, 154, 200, 0.8), 0 0 20px rgba(201, 167, 255, 0.6);
    }

    @keyframes twinkle {
      0%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
      }
      50% {
        opacity: 1;
        transform: scale(1.2);
      }
    }

    .star-sparkle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 6px rgba(255, 154, 200, 0.9), 0 0 12px rgba(201, 167, 255, 0.7);
      animation: sparkleFloat 4s ease-in-out infinite;
    }

    @keyframes sparkleFloat {
      0% {
        transform: translateY(0) scale(0);
        opacity: 0;
      }
      50% {
        transform: translateY(-20px) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(-40px) scale(0);
        opacity: 0;
      }
    }

    header.hero {
      position: relative;
      min-height: calc(100vh - 80px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 6rem 2rem 4rem;
      text-align: center;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.9), rgba(255, 220, 246, 0.7));
      overflow: hidden;
    }

    /* Birthday decorations - Balloons */
    .balloon {
      position: absolute;
      width: 50px;
      height: 70px;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: float 6s ease-in-out infinite;
      z-index: 1;
    }

    .balloon::after {
      content: '';
      position: absolute;
      bottom: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 50px;
      background: rgba(0, 0, 0, 0.2);
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0) translateX(0);
      }
      50% {
        transform: translateY(-20px) translateX(10px);
      }
    }

    .balloon.pink {
      background: linear-gradient(135deg, var(--pink), #ff6bb3);
      left: 10%;
      top: 20%;
      animation-delay: 0s;
    }

    .balloon.lavender {
      background: linear-gradient(135deg, var(--lavender), #a87eff);
      right: 15%;
      top: 30%;
      animation-delay: 1s;
    }

    .balloon.mint {
      background: linear-gradient(135deg, var(--mint), #7fffc4);
      left: 20%;
      bottom: 25%;
      animation-delay: 2s;
    }

    .balloon.yellow {
      background: linear-gradient(135deg, var(--soft-yellow), #ffeb80);
      right: 10%;
      bottom: 20%;
      animation-delay: 1.5s;
    }

    /* Streamers */
    .streamer {
      position: absolute;
      width: 4px;
      height: 100vh;
      background: linear-gradient(to bottom, var(--pink), var(--lavender), var(--mint));
      animation: streamerSway 3s ease-in-out infinite;
      top: 0;
      z-index: 1;
    }

    @keyframes streamerSway {
      0%, 100% {
        transform: rotate(-2deg);
      }
      50% {
        transform: rotate(2deg);
      }
    }

    .streamer.left {
      left: 5%;
      animation-delay: 0s;
    }

    .streamer.right {
      right: 5%;
      animation-delay: 1s;
    }

    /* Party hats */
    .party-hat {
      position: absolute;
      font-size: 2.5rem;
      animation: hatBounce 2s ease-in-out infinite;
      z-index: 1;
    }

    @keyframes hatBounce {
      0%, 100% {
        transform: translateY(0) rotate(0deg);
      }
      50% {
        transform: translateY(-10px) rotate(5deg);
      }
    }

    /* Gifts */
    .gift-box {
      position: absolute;
      width: 60px;
      height: 60px;
      background: var(--pink);
      border: 3px solid rgba(255, 255, 255, 0.8);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      animation: giftShake 3s ease-in-out infinite;
      cursor: pointer;
      z-index: 1;
    }

    .gift-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 30%;
      background: var(--lavender);
    }

    .gift-box::after {
      content: 'üéÅ';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.5rem;
    }

    @keyframes giftShake {
      0%, 100% {
        transform: rotate(0deg);
      }
      25% {
        transform: rotate(-5deg);
      }
      75% {
        transform: rotate(5deg);
      }
    }

    .gift-box:hover {
      transform: scale(1.2);
      animation-play-state: paused;
    }

    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      padding: 1rem 2rem;
      z-index: 100;
      box-shadow: 0 10px 30px rgba(188, 160, 255, 0.2);
    }

    .nav a {
      text-decoration: none;
      color: #7f3d84;
      font-weight: 600;
      border-bottom: 3px solid transparent;
      padding-bottom: 0.2rem;
      transition: all 0.3s ease;
      position: relative;
      cursor: pointer;
    }

    .nav a:hover {
      border-bottom-color: var(--lavender);
      color: var(--deep-purple);
      transform: translateY(-2px);
    }

    .nav a.active {
      border-bottom-color: var(--deep-purple);
      color: var(--deep-purple);
    }

      .nav a::before {
      content: '‚ú®';
      position: absolute;
      left: -1.5rem;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .nav a.active::before {
      opacity: 1;
    }

    @media (max-width: 768px) {
      .nav a::before {
        display: none;
      }
      
      .balloon, .party-hat, .gift-box {
        display: none;
      }
    }

    .hero h1 {
      font-size: clamp(2.6rem, 4vw, 3.8rem);
      margin-bottom: 1rem;
      animation: glow 3s ease-in-out infinite alternate;
      text-shadow: 0 0 20px rgba(255, 154, 200, 0.5), 0 0 40px rgba(201, 167, 255, 0.3);
    }

    @keyframes glow {
      from {
        text-shadow: 0 0 20px rgba(255, 154, 200, 0.5), 0 0 40px rgba(201, 167, 255, 0.3);
      }
      to {
        text-shadow: 0 0 30px rgba(255, 154, 200, 0.8), 0 0 60px rgba(201, 167, 255, 0.5), 0 0 80px rgba(181, 227, 255, 0.3);
      }
    }

    .hero p {
      max-width: 650px;
      font-size: 1.25rem;
      line-height: 1.7;
      position: relative;
    }

    .hero p .cursor {
      display: inline-block;
      width: 3px;
      height: 1.25rem;
      background: var(--deep-purple);
      margin-left: 2px;
      animation: blink 1s infinite;
      vertical-align: baseline;
    }

    @keyframes blink {
      0%, 49% { opacity: 1; }
      50%, 100% { opacity: 0; }
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }

    .btn {
      background: var(--gradient);
      color: #5d2e75;
      border: none;
      padding: 0.9rem 1.8rem;
      border-radius: 999px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--soft-shadow);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 25px 45px rgba(140, 82, 255, 0.25), 0 0 20px rgba(255, 154, 200, 0.4);
    }

    .btn:active {
      transform: translateY(-2px);
    }

    section {
      padding: 3rem 2rem;
      position: relative;
      z-index: 1;
    }

    h2.section-title {
      text-align: center;
      font-size: 2.4rem;
      margin-bottom: 3rem;
      color: #6d2d7c;
      text-shadow: 0 10px 35px rgba(111, 63, 140, 0.25);
      position: relative;
      display: inline-block;
      width: 100%;
      padding: 0 3rem;
    }

    h2.section-title::before,
    h2.section-title::after {
      content: '‚ú®';
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      animation: sparkle 2s ease-in-out infinite;
    }

    h2.section-title::before {
      left: 0;
    }

    h2.section-title::after {
      right: 0;
    }

    @keyframes sparkle {
      0%, 100% {
        opacity: 0.5;
        transform: translateY(-50%) scale(0.8);
      }
      50% {
        opacity: 1;
        transform: translateY(-50%) scale(1.2);
      }
    }

    /* Instagram-style Memory Feed */
    .memory-feed {
      max-width: 600px;
      margin: 2rem auto;
      display: grid;
      gap: 2rem;
      padding-bottom: 2rem;
    }

    .instagram-post {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid rgba(255, 154, 200, 0.2);
    }

    .instagram-post:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(255, 154, 200, 0.3);
    }

    .post-header {
      padding: 1rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    }

    .post-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      font-weight: bold;
      color: white;
      flex-shrink: 0;
    }

    .post-username {
      font-weight: 600;
      color: #4c2b57;
      font-size: 0.95rem;
    }

    .post-date {
      font-size: 0.85rem;
      color: #999;
      margin-left: auto;
    }

    .post-image-container {
      width: 100%;
      aspect-ratio: 1;
      overflow: hidden;
      background: #f0f0f0;
      position: relative;
      cursor: pointer;
    }

    .post-image-container img,
    .post-image-container video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .post-caption {
      padding: 1rem;
      color: #4c2b57;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .post-caption strong {
      color: #6d2d7c;
      font-weight: 600;
    }

    .post-actions {
      padding: 0.75rem 1rem;
      display: flex;
      gap: 1rem;
      border-top: 1px solid rgba(0, 0, 0, 0.08);
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    }

    .post-action-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.2s ease;
      padding: 0;
      line-height: 1;
    }

    .post-action-btn:hover {
      transform: scale(1.2);
    }

    /* Add Memory Button */
    .add-memory-btn {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--gradient);
      border: none;
      font-size: 1.8rem;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(255, 154, 200, 0.4);
      z-index: 50;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .add-memory-btn:hover {
      transform: scale(1.1) rotate(90deg);
      box-shadow: 0 6px 30px rgba(255, 154, 200, 0.6);
    }

    /* Add Memory Modal */
    .add-memory-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(36, 17, 52, 0.88);
      -webkit-backdrop-filter: blur(8px);
      backdrop-filter: blur(8px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .add-memory-modal.active {
      display: flex;
      opacity: 1;
    }

    .add-memory-content {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 30px;
      padding: 2.5rem;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 30px 60px rgba(0,0,0,0.5), 0 0 40px rgba(255,154,200,0.3);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .add-memory-modal.active .add-memory-content {
      transform: scale(1);
    }

    .add-memory-form input[type="text"],
    .add-memory-form input[type="file"],
    .add-memory-form textarea {
      width: 100%;
      padding: 0.8rem;
      border-radius: 12px;
      border: 2px solid rgba(255, 154, 200, 0.3);
      font-size: 1rem;
      font-family: inherit;
      margin-bottom: 1rem;
      box-sizing: border-box;
    }

    .add-memory-form input[type="file"] {
      cursor: pointer;
      background: rgba(255, 255, 255, 0.9);
    }

    .add-memory-form label {
      display: block;
      margin-bottom: 0.5rem;
      color: #6d2d7c;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .add-memory-form input:focus,
    .add-memory-form textarea:focus {
      outline: none;
      border-color: var(--pink);
      box-shadow: 0 0 0 3px rgba(255, 154, 200, 0.2);
    }

    .add-memory-form textarea {
      min-height: 100px;
      resize: vertical;
    }

    .timeline {
      display: grid;
      gap: 2rem;
    }

    .memory-card {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      border-radius: var(--card-radius);
      background: rgba(255, 255, 255, 0.88);
      box-shadow: var(--soft-shadow);
      padding: 1.5rem;
      border: 2px dashed rgba(255, 154, 200, 0.5);
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .memory-card::after {
      content: '';
      position: absolute;
      inset: 0;
      background: url('https://www.transparenttextures.com/patterns/white-wall.png');
      mix-blend-mode: soft-light;
      opacity: 0.3;
      pointer-events: none;
    }

    .memory-card:hover {
      transform: translateY(-6px) rotate(-0.5deg);
      box-shadow: 0 25px 50px rgba(118, 74, 170, 0.3), 0 0 30px rgba(255, 154, 200, 0.4);
      border-color: rgba(255, 154, 200, 0.8);
    }

    .memory-media {
      border-radius: 18px;
      overflow: hidden;
      border: 4px solid rgba(255, 255, 255, 0.8);
      position: relative;
    }

    .memory-media img,
    .memory-media video {
      width: 100%;
      display: block;
      aspect-ratio: 16/9;
      object-fit: cover;
    }

    .sticker {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: var(--soft-yellow);
      border-radius: 14px;
      padding: 0.4rem 0.9rem;
      font-size: 0.85rem;
      font-weight: 700;
      color: #6b305f;
      box-shadow: 0 10px 25px rgba(255, 242, 178, 0.7), 0 0 15px rgba(255, 242, 178, 0.5);
      animation: float 3s ease-in-out infinite;
      z-index: 10;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(-2deg); }
      50% { transform: translateY(-8px) rotate(2deg); }
    }

    .flaps-grid,
    .collage-grid,
    .guestbook-wall {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 1.5rem;
    }

    .flap-card {
      position: relative;
      perspective: 1500px;
      height: 220px;
    }

    .flap-card button {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: var(--card-radius);
      background: var(--gradient);
      color: #5a2671;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--soft-shadow);
      transition: transform 0.6s;
      transform-style: preserve-3d;
      position: relative;
    }

    .flap-card.open button {
      transform: rotateY(180deg);
    }

    .flap-front,
    .flap-back {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.2rem;
      text-align: center;
    }

    .flap-back {
      transform: rotateY(180deg);
      background: rgba(255, 255, 255, 0.95);
      color: #623076;
      font-size: 0.95rem;
    }

    .slideshow {
      position: relative;
      border-radius: var(--card-radius);
      overflow: hidden;
      box-shadow: var(--soft-shadow);
      border: 6px double rgba(255, 255, 255, 0.8);
    }

    .slideshow img {
      width: 100%;
      display: none;
      animation: gentleZoom 12s ease-in-out infinite;
    }

    .slideshow img.active {
      display: block;
    }

    @keyframes gentleZoom {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .collage-grid figure {
      background: rgba(255, 255, 255, 0.92);
      border-radius: 40px 10px 35px 15px;
      padding: 0.7rem;
      border: 3px dotted rgba(255, 154, 200, 0.5);
      box-shadow: var(--soft-shadow);
    }

    .collage-grid img {
      width: 100%;
      border-radius: 30px 8px 30px 12px;
      display: block;
    }

    .celebration-playground {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 2rem;
    }

    .cake-card,
    .wheel-card,
    .pull-tab {
      background: rgba(255, 255, 255, 0.92);
      border-radius: var(--card-radius);
      padding: 1.8rem;
      box-shadow: var(--soft-shadow);
      position: relative;
    }

    .cake {
      width: 160px;
      height: 140px;
      margin: 0 auto;
      position: relative;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .cake:hover {
      transform: translateY(-6px);
    }

    .cake .layer {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 160px;
      height: 60px;
      background: var(--pink);
      border-radius: 30px 30px 12px 12px;
      box-shadow: inset 0 -8px rgba(0,0,0,0.08);
    }

    .cake .layer.top {
      top: 0;
      width: 120px;
      height: 50px;
      border-radius: 30px;
      background: var(--lavender);
    }

    .candle {
      position: absolute;
      width: 8px;
      height: 35px;
      background: white;
      border-radius: 20px;
      top: -25px;
      left: calc(50% - 4px);
    }

    .flame {
      position: absolute;
      top: -12px;
      left: -5px;
      width: 18px;
      height: 28px;
      background: radial-gradient(circle, var(--soft-yellow), orange);
      border-radius: 50% 50% 50% 50%;
      animation: flicker 0.6s infinite alternate;
      opacity: 1;
      transform-origin: center;
    }

    @keyframes flicker {
      from { transform: scale(1) rotate(-2deg); }
      to { transform: scale(1.1) rotate(2deg); }
    }

    .cake[data-lit="false"] .flame {
      opacity: 0;
    }

    .wheel {
      width: 220px;
      height: 220px;
      border-radius: 50%;
      margin: 0 auto;
      background: conic-gradient(var(--pink) 0 60deg, var(--mint) 60deg 120deg, var(--lavender) 120deg 180deg, var(--soft-yellow) 180deg 240deg, var(--sky) 240deg 300deg, var(--pink) 300deg 360deg);
      display: grid;
      place-items: center;
      color: #6b2d6d;
      font-weight: 700;
      transition: transform 4s cubic-bezier(0.25, 1, 0.3, 1);
    }

    .wheel-pointer {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-bottom: 25px solid #ff83b1;
    }

    .pull-tab button {
      width: 100%;
      border: none;
      background: var(--gradient);
      border-radius: 999px;
      padding: 0.7rem 1.2rem;
      font-weight: 600;
      cursor: pointer;
      color: #5d2e75;
      box-shadow: var(--soft-shadow);
    }

    .pull-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease;
      margin-top: 1rem;
      color: #5a2f68;
      line-height: 1.5;
    }

    .pull-tab.open .pull-content {
      max-height: 200px;
    }

    .guestbook-wall .note {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 1rem;
      border: 2px dashed rgba(181, 227, 255, 0.7);
      min-height: 120px;
      position: relative;
    }

    .note::before {
      content: '';
      position: absolute;
      top: 10px;
      right: 16px;
      font-size: 1.2rem;
    }

    form#guestbookForm {
      margin-top: 2rem;
      display: grid;
      gap: 1rem;
    }

    form input,
    form textarea {
      border-radius: 18px;
      border: none;
      padding: 1rem;
      font-size: 1rem;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: inset 0 0 0 2px rgba(255, 154, 200, 0.2);
      resize: none;
    }

    footer {
      text-align: center;
      padding: 3rem 1rem;
      background: rgba(255, 255, 255, 0.8);
      color: #6c3e74;
    }

    @media (max-width: 768px) {
      .nav {
        justify-content: space-between;
        font-size: 0.85rem;
        gap: 0.8rem;
        padding: 0.8rem 1rem;
        flex-wrap: wrap;
      }

      .nav a {
        font-size: 0.9rem;
      }

      section {
        padding: 3rem 1.5rem;
      }

      .page {
        padding-top: 70px;
      }

      .celebration-playground {
        grid-template-columns: 1fr;
      }

      h2.section-title {
        font-size: 2rem;
      }

      h2.section-title::before,
      h2.section-title::after {
        display: none;
      }

      .hero {
        padding: 5rem 1.5rem 3rem;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .hero p {
        font-size: 1.1rem;
      }

      .memory-card {
        padding: 1.2rem;
      }

      .flap-card,
      .wheel {
        height: 180px;
      }

      .wheel {
        width: 180px;
      }

      .stars-container .star {
        font-size: 1.2rem;
      }

      #lightbox {
        padding: 1rem;
      }

      #closeLightbox {
        top: 1rem;
        right: 1rem;
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .button-group {
        flex-direction: column;
        width: 100%;
      }

      .btn {
        width: 100%;
      }

      .guestbook-wall {
        grid-template-columns: 1fr;
      }

      .collage-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="stars-container" id="starsContainer" aria-hidden="true"></div>
  <div class="confetti-splash" aria-hidden="true"></div>
  <canvas id="celebrationCanvas"></canvas>

  <audio id="birthdayAudio" loop src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f4f4bcc1f8.mp3?filename=birthday-111331.mp3"></audio>

  <nav class="nav">
    <a href="#" data-page="home" class="active">Home</a>
    <a href="#" data-page="memories">Memories</a>
    <a href="#" data-page="messages">Messages</a>
    <a href="#" data-page="celebration">Celebration</a>
    <a href="#" data-page="surprise">Surprise</a>
  </nav>

  <!-- HOME PAGE -->
  <div id="home" class="page active">
    <header class="hero">
      <div class="balloon pink"></div>
      <div class="balloon lavender"></div>
      <div class="balloon mint"></div>
      <div class="balloon yellow"></div>
      <div class="streamer left"></div>
      <div class="streamer right"></div>
      <div class="party-hat" style="top: 15%; left: 8%;">üé©</div>
      <div class="party-hat" style="top: 20%; right: 12%;">üéâ</div>
      <div class="gift-box" style="bottom: 15%; left: 15%;" title="Click for surprise!"></div>
      <div class="gift-box" style="bottom: 20%; right: 20%; background: var(--lavender);" title="Click for surprise!"></div>
      
      <h1>Happy Birthday, Starfriend! üéÇ</h1>
      <p id="typedMessage"></p>
      <div class="button-group">
        <button class="btn" id="celebrationBtn">üéä Confetti Mode üéä</button>
        <button class="btn" id="audioToggle">üéµ Play Music üéµ</button>
        <button class="btn" onclick="showPage('memories')">üì∏ Explore Memories</button>
      </div>
    </header>
  </div>

  <!-- MEMORIES PAGE -->
  <div id="memories" class="page">
    <div class="party-hat" style="top: 100px; left: 10%;">üì∏</div>
    <div class="party-hat" style="top: 120px; right: 12%;">üì∑</div>
    <div class="balloon pink" style="top: 15%; left: 5%;"></div>
    <div class="balloon lavender" style="top: 20%; right: 8%;"></div>
    <section>
    <h2 class="section-title">üì∏ Memory Feed üì∏</h2>
    <div class="memory-feed" id="memoryFeed">
      <!-- Memories will be dynamically loaded here -->
    </div>
    <button class="add-memory-btn" id="addMemoryBtn" title="Add New Memory">‚ûï</button>

    <!-- Add Memory Modal -->
    <div class="add-memory-modal" id="addMemoryModal">
      <div class="add-memory-content">
        <h3 style="text-align: center; color: #6d2d7c; margin-bottom: 1.5rem; font-size: 1.8rem;">‚ú® Add New Memory ‚ú®</h3>
        <form class="add-memory-form" id="addMemoryForm">
          <label style="display: block; margin-bottom: 0.5rem; color: #6d2d7c; font-weight: 600;">Choose or Upload Image üì∑</label>
          <input type="file" id="memoryImageFile" accept="image/*" style="margin-bottom: 0.5rem;" />
          <div style="text-align: center; margin: 0.5rem 0; color: #999; font-size: 0.9rem;">OR</div>
          <input type="text" id="memoryImageUrl" placeholder="Paste image URL here (optional)" />
          <div id="imagePreview" style="margin-top: 1rem; display: none;">
            <img id="previewImg" src="" alt="Preview" style="max-width: 100%; max-height: 200px; border-radius: 12px; border: 2px solid rgba(255, 154, 200, 0.3);" />
          </div>
          <input type="text" id="memoryUsername" placeholder="Username (e.g., Birthday Girl) üë§" value="Birthday Girl" required style="margin-top: 1rem;" />
          <textarea id="memoryCaption" placeholder="Write your memory caption here... üí≠" required></textarea>
          <div style="display: flex; gap: 1rem;">
            <button type="submit" class="btn" style="flex: 1;">Add Memory ‚ú®</button>
            <button type="button" class="btn" id="closeAddMemoryModal" style="flex: 1; background: rgba(255, 255, 255, 0.9); color: #6d2e75;">Cancel</button>
          </div>
        </form>
        <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 154, 200, 0.1); border-radius: 12px; font-size: 0.9rem; color: #6d2d7c;">
          <strong>üí° Easy Image Upload:</strong>
          <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
            <li>Click "Choose File" to select from your device</li>
            <li>Or upload to <a href="https://imgur.com" target="_blank">Imgur</a> / <a href="https://imgbb.com" target="_blank">ImgBB</a> and paste URL</li>
            <li>Image will be converted to URL automatically</li>
          </ul>
        </div>
      </div>
    </div>
    </section>
  </div>

  <!-- MESSAGES PAGE -->
  <div id="messages" class="page">
        <div class="memory-media">
          <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=900&q=80" alt="Memory 2018" />
          <span class="sticker">2018</span>
        </div>
        <h3>First College Adventure</h3>
        <p>Remember how we got lost on day one and discovered the coziest cafe instead? Best accidental tradition ever.</p>
      </article>

      <article class="memory-card" data-type="video" data-media="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4">
        <div class="memory-media">
          <video muted loop poster="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=900&q=80">
            <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4" />
          </video>
          <span class="sticker">2019</span>
        </div>
        <h3>Festival Lights Video</h3>
        <p>Our very first vlog attempt ÔøΩ shaky camera, endless laughter, and pure magic.</p>
      </article>

      <article class="memory-card" data-type="image" data-media="https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=900&q=80">
        <div class="memory-media">
          <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=900&q=80" alt="Memory 2021" />
          <span class="sticker">2021</span>
        </div>
        <h3>Roadtrip Polaroids</h3>
        <p>That sunrise over the hills still feels unreal. We actually chased the clouds!</p>
      </article>

      <article class="memory-card" data-type="image" data-media="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=900&q=80">
        <div class="memory-media">
          <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=900&q=80" alt="Memory 2024" />
          <span class="sticker">2024</span>
        </div>
        <h3>Starry Rooftop Sessions</h3>
        <p>Blankets, fairy lights, and unstoppable dream-building. The perfect ritual.</p>
      </article>
    </div>

    </section>
  </div>

  <!-- MESSAGES PAGE -->
  <div id="messages" class="page">
    <div class="balloon mint" style="top: 18%; left: 8%;"></div>
    <div class="balloon yellow" style="top: 22%; right: 10%;"></div>
    <div class="party-hat" style="top: 150px; left: 15%;">üíå</div>
    <div class="gift-box" style="top: 120px; right: 15%; background: var(--mint);"></div>
    <section>
    <h2 class="section-title">üíå Lift-the-Flap Surprises üíå</h2>
    <div class="flaps-grid">
      <div class="flap-card">
        <button>
          <span class="flap-front">Open me for sparkly memories </span>
          <span class="flap-back">You are the kind of friend who turns ordinary Tuesdays into constellations of joy. Never stop shining.</span>
        </button>
      </div>
      <div class="flap-card">
        <button>
          <span class="flap-front">A hidden photo awaits </span>
          <span class="flap-back"><img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=600&q=80" alt="Hidden polaroid" /></span>
        </button>
      </div>
      <div class="flap-card">
        <button>
          <span class="flap-front">Mini video letter </span>
          <span class="flap-back">Scan this QR-shaped hug:  Remember our karaoke chaos? A remix is waiting!</span>
        </button>
      </div>
    </div>
    </section>
  </div>

  <!-- CELEBRATION PAGE -->
  <div id="celebration" class="page">
    <div class="balloon pink" style="top: 12%; left: 12%;"></div>
    <div class="balloon lavender" style="top: 15%; right: 15%;"></div>
    <div class="balloon mint" style="bottom: 25%; left: 10%;"></div>
    <div class="balloon yellow" style="bottom: 20%; right: 12%;"></div>
    <div class="party-hat" style="top: 100px; left: 20%;">üéâ</div>
    <div class="party-hat" style="top: 120px; right: 18%;">üéä</div>
    <div class="gift-box" style="top: 180px; left: 8%;"></div>
    <div class="gift-box" style="top: 200px; right: 10%; background: var(--soft-yellow);"></div>
    <section>
    <h2 class="section-title">üéâ Pop-up Celebration Playground üéâ</h2>
    <div class="celebration-playground">
      <div class="cake-card">
        <h3>Click to blow out the candles!</h3>
        <div class="cake" id="birthdayCake" data-lit="true">
          <div class="layer"></div>
          <div class="layer top"></div>
          <div class="candle">
            <div class="flame"></div>
          </div>
        </div>
        <p id="cakeMessage">Make a wish and tap the cake to blow out the candle.</p>
      </div>

      <div class="wheel-card">
        <div class="wheel-pointer"></div>
        <div class="wheel" id="wishWheel">Spin Me!</div>
        <button class="btn" id="spinWheelBtn" style="margin-top:1rem;">Spin for a wish</button>
        <p id="wheelResult"></p>
      </div>

      <div class="pull-tab">
        <button class="pull-btn">Pull for "Before vs Now" story</button>
        <div class="pull-content">
          <strong>Then:</strong> Two shy dreamers whispering ideas at the back row.<br />
          <strong>Now:</strong> Bold creators building memories louder than fireworks.
        </div>
      </div>
      <div class="pull-tab">
        <button class="pull-btn">Tap for a goofy challenge</button>
        <div class="pull-content">Record a 15-second "birthday weather report" in your best dramatic voice. Send it to me tonight!</div>
      </div>
    </div>
    </section>
  </div>

  <!-- GUESTBOOK PAGE -->
  <div id="surprise" class="page">
    <div class="balloon pink" style="top: 15%; left: 7%;"></div>
    <div class="balloon lavender" style="top: 18%; right: 9%;"></div>
    <div class="party-hat" style="top: 130px; left: 12%;">üéÅ</div>
    <div class="party-hat" style="top: 150px; right: 14%;">üéâ</div>
    <div class="gift-box" style="bottom: 30%; left: 12%; background: var(--sky);"></div>
    <section>
    <h2 class="section-title">üéÅ Surprise Wish üéÅ</h2>
    <div class="surprise-banner" style="max-width: 900px; margin: 2rem auto; border-radius: var(--card-radius); overflow: hidden; box-shadow: var(--soft-shadow); border: 4px solid rgba(255, 154, 200, 0.5);">
      <img src="https://images.unsplash.com/photo-1511988617509-a57c8a288659?auto=format&fit=crop&w=1200&q=80" alt="Birthday Wish Banner" style="width: 100%; display: block; height: auto; max-height: 500px; object-fit: cover;" />
    </div>
    <div style="text-align: center; margin-top: 2rem; max-width: 800px; margin-left: auto; margin-right: auto; padding: 2rem; background: rgba(255, 255, 255, 0.9); border-radius: var(--card-radius); box-shadow: var(--soft-shadow);">
      <p style="font-size: 1.2rem; line-height: 1.8; color: #6d2d7c;">Here's to another amazing year filled with joy, laughter, and unforgettable moments! May all your wishes come true! ‚ú®</p>
    </div>
    <!-- Old guestbook removed -->
    <div style="display:none;">
      <div class="note">
        "From sunrise pep-talks to midnight snack raids, you are pure delight." ÔøΩ A Secret Well-Wisher 
      </div>
    </div>
    </div>
    </section>
  </div>

  <div id="lightbox" aria-hidden="true" style="display:none; position:fixed; inset:0; background:rgba(36,17,52,0.88); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px); z-index:900; align-items:center; justify-content:center; padding:2rem; opacity:0; transition: opacity 0.3s ease;">
    <button id="closeLightbox" class="btn" style="position:absolute; top:2rem; right:2rem; z-index:901;">Close ‚úï</button>
    <div id="lightboxContent" style="max-width:900px; width:100%; border-radius:24px; overflow:hidden; box-shadow:0 30px 60px rgba(0,0,0,0.5), 0 0 40px rgba(255,154,200,0.3); transform: scale(0.9); transition: transform 0.3s ease;"></div>
  </div>

  <footer style="text-align: center; padding: 2rem 1rem; background: rgba(255, 255, 255, 0.8); color: #6c3e74; position: relative; z-index: 1;">
    Made with ‚ú® glitter, üíª code, and üíñ so much love.
  </footer>

  <script>
    const typedText = "From our silliest bloopers to the boldest dreams, today celebrates the woman who colors every chapter of my story. Happy Birthday, bestie!";
    const typedMessageEl = document.getElementById('typedMessage');
    let charIndex = 0;
    function typeLoop() {
      if (charIndex <= typedText.length) {
        typedMessageEl.innerHTML = typedText.slice(0, charIndex) + '<span class="cursor">|</span>';
        charIndex++;
        setTimeout(typeLoop, 60);
      } else {
        typedMessageEl.innerHTML = typedText;
      }
    }

    // Multi-page navigation system
    window.showPage = function(pageId) {
      // Hide all pages
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      // Show selected page
      const targetPage = document.getElementById(pageId);
      if (targetPage) {
        targetPage.classList.add('active');
        
        // Update navigation active state
        document.querySelectorAll('.nav a').forEach(link => {
          link.classList.remove('active');
        });
        const navLink = document.querySelector(`[data-page="${pageId}"]`);
        if (navLink) navLink.classList.add('active');
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        // Trigger page-specific animations
        if (pageId === 'home') {
          // Add more confetti on home page visit
          for (let i = 0; i < 30; i++) {
            setTimeout(createConfettiPiece, i * 50);
          }
        }
        
        // Add sparkles when switching pages
        setTimeout(() => {
          for (let i = 0; i < 10; i++) {
            setTimeout(() => {
              createSparkle(
                Math.random() * window.innerWidth,
                Math.random() * window.innerHeight
              );
            }, i * 50);
          }
        }, 200);
      }
    };

    // Navigation click handlers
    document.querySelectorAll('.nav a[data-page]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const pageId = link.getAttribute('data-page');
        showPage(pageId);
      });
    });

    document.addEventListener('DOMContentLoaded', () => {
      typeLoop();
      document.getElementById('birthdayAudio').volume = 0.4;
      
      // Gift box interactions
      document.querySelectorAll('.gift-box').forEach((gift, index) => {
        gift.addEventListener('click', () => {
          // Create sparkle burst
          const rect = gift.getBoundingClientRect();
          for (let i = 0; i < 20; i++) {
            setTimeout(() => {
              createSparkle(
                rect.left + rect.width / 2 + (Math.random() - 0.5) * 80,
                rect.top + rect.height / 2 + (Math.random() - 0.5) * 80
              );
            }, i * 30);
          }
          
          // Show surprise message
          const messages = [
            'üéÅ Surprise! You found a hidden gift!',
            'üéâ You\'re amazing! Keep exploring!',
            '‚ú® Your presence is the best gift!',
            'üéä Happy Birthday, superstar!'
          ];
          const surprise = document.createElement('div');
          surprise.textContent = messages[index % messages.length];
          surprise.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--gradient);
            padding: 2rem 3rem;
            border-radius: 30px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #5d2e75;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: popIn 0.5s ease-out;
          `;
          document.body.appendChild(surprise);
          setTimeout(() => {
            surprise.style.animation = 'popOut 0.5s ease-in forwards';
            setTimeout(() => surprise.remove(), 500);
          }, 2000);
          
          // Trigger mini confetti
          launchCelebration();
        });
      });
    });
    
    // Add pop animations for gift messages
    const giftStyle = document.createElement('style');
    giftStyle.innerHTML = `
      @keyframes popIn {
        from {
          transform: translate(-50%, -50%) scale(0);
          opacity: 0;
        }
        to {
          transform: translate(-50%, -50%) scale(1);
          opacity: 1;
        }
      }
      @keyframes popOut {
        from {
          transform: translate(-50%, -50%) scale(1);
          opacity: 1;
        }
        to {
          transform: translate(-50%, -50%) scale(0.5);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(giftStyle);

    // Floating stars animation
    const starsContainer = document.getElementById('starsContainer');
    const starEmojis = ['‚ú®', '‚≠ê', 'üåü', 'üí´', '‚≠ê'];
    
    function createStar() {
      const star = document.createElement('div');
      star.className = 'star';
      star.textContent = starEmojis[Math.floor(Math.random() * starEmojis.length)];
      star.style.left = `${Math.random() * 100}%`;
      star.style.top = `${Math.random() * 100}%`;
      star.style.animationDelay = `${Math.random() * 3}s`;
      star.style.animationDuration = `${3 + Math.random() * 2}s`;
      starsContainer.appendChild(star);
    }

    for (let i = 0; i < 20; i++) {
      createStar();
    }

    // Sparkle effects
    function createSparkle(x, y) {
      const sparkle = document.createElement('div');
      sparkle.className = 'star-sparkle';
      sparkle.style.left = `${x}px`;
      sparkle.style.top = `${y}px`;
      sparkle.style.animationDelay = `${Math.random() * 0.5}s`;
      document.body.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 4000);
    }

    // Add sparkles on hover over birthday elements (dynamic delegation for Instagram posts)
    document.addEventListener('mouseenter', (e) => {
      const target = e.target.closest('.btn, .memory-card, .cake, .flap-card button, .instagram-post, .post-action-btn');
      if (target && !target.dataset.sparkled) {
        target.dataset.sparkled = 'true';
        const rect = target.getBoundingClientRect();
        for (let i = 0; i < 3; i++) {
          setTimeout(() => {
            createSparkle(
              rect.left + Math.random() * rect.width,
              rect.top + Math.random() * rect.height
            );
          }, i * 100);
        }
        setTimeout(() => delete target.dataset.sparkled, 1000);
      }
    }, true);

    // hero confetti sprinkles
    const confettiSplash = document.querySelector('.confetti-splash');
    function createConfettiPiece() {
      const piece = document.createElement('span');
      const size = Math.random() * 8 + 6;
      piece.style.position = 'absolute';
      piece.style.width = `${size}px`;
      piece.style.height = `${size * 0.4}px`;
      piece.style.background = `hsl(${Math.random()*360}, 80%, 75%)`;
      piece.style.top = '-10px';
      piece.style.left = `${Math.random() * 100}%`;
      piece.style.opacity = 0.8;
      piece.style.transform = `rotate(${Math.random()*180}deg)`;
      piece.style.animation = `fall ${5 + Math.random()*3}s linear forwards`;
      confettiSplash.appendChild(piece);
      setTimeout(() => piece.remove(), 9000);
    }

    for (let i = 0; i < 90; i++) {
      setTimeout(createConfettiPiece, i * 70);
    }

    const style = document.createElement('style');
    style.innerHTML = `@keyframes fall { to { transform: translateY(110vh) rotate(360deg); opacity: 0; } }`;
    document.head.appendChild(style);

    // Lightbox behavior
    const lightbox = document.getElementById('lightbox');
    const lightboxContent = document.getElementById('lightboxContent');
    let currentVideo = null;

    function openLightbox(media, type) {
      lightboxContent.innerHTML = '';
      lightboxContent.style.transform = 'scale(0.9)';
      
      if (type === 'video') {
        const video = document.createElement('video');
        video.controls = true;
        video.src = media;
        video.style.width = '100%';
        video.style.display = 'block';
        lightboxContent.appendChild(video);
        currentVideo = video;
        video.play().catch(() => {});
      } else {
        const img = document.createElement('img');
        img.src = media;
        img.alt = 'Expanded memory';
        img.style.width = '100%';
        img.style.display = 'block';
        lightboxContent.appendChild(img);
      }
      
      lightbox.style.display = 'flex';
      requestAnimationFrame(() => {
        lightbox.style.opacity = '1';
        lightboxContent.style.transform = 'scale(1)';
      });
    }

    function closeLightbox() {
      if (currentVideo) {
        currentVideo.pause();
        currentVideo = null;
      }
      lightbox.style.opacity = '0';
      lightboxContent.style.transform = 'scale(0.9)';
      setTimeout(() => {
        lightbox.style.display = 'none';
        lightboxContent.innerHTML = '';
      }, 300);
    }

    // Memory Feed System - Easy Instagram-style posts
    const memoriesData = [
      {
        image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'First College Adventure ‚ú® Remember how we got lost on day one and discovered the coziest cafe instead? Best accidental tradition ever. üíï'
      },
      {
        image: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Starry Rooftop Sessions ‚≠ê Blankets, fairy lights, and unstoppable dream-building. The perfect ritual. üåô‚ú®'
      },
      {
        image: 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Sholingur üèõÔ∏è Our first temple visit together! The peaceful vibes and beautiful architecture made it unforgettable. üôè‚ú®'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Vellore üè∞ Exploring the historic fort and discovering hidden stories together. What an adventure! üì∏üíï'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Theerthagiri Murugan Temple ‚õ©Ô∏è The divine atmosphere and stunning architecture left us in awe. Beautiful memories! üåü'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Thiruthani üôè Another spiritual journey, another beautiful memory created. The climb was worth every step! üèîÔ∏è'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Thirupathi üïâÔ∏è Our pilgrimage together was filled with prayers, peace, and precious moments. Truly blessed! ‚ú®'
      },
      {
        image: 'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Vadapalani üè™ Shopping spree and street food adventures! The best kind of day out together! üõçÔ∏èüçú'
      },
      {
        image: 'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Express Avenue Mall üè¨ Endless shopping, food court feasts, and fun times! Shopping with you is always the best! üíïüõí'
      },
      {
        image: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Bessy Beach üåä Sunset walks, sand between our toes, and endless conversations. Beach days with you are pure magic! üåÖ'
      },
      {
        image: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Marina Beach üèñÔ∏è The longest beach walk, street food, and unforgettable memories! Classic Chennai vibes! üåä‚ú®'
      },
      {
        image: 'https://images.unsplash.com/photo-1528607929212-2636ec44253e?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'KFC üçó Our go-to comfort food place! Crispy chicken, unlimited laughs, and the best conversations. Foodie memories! üçü'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Virudhachalam üèõÔ∏è Another temple, another beautiful adventure. The spiritual journey continues! üôèüí´'
      },
      {
        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Kanchipuram üèõÔ∏è The city of temples! Exploring history, architecture, and creating memories one temple at a time! üì∏'
      },
      {
        image: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Kolivakkam üåä Beach vibes, fresh air, and the perfect escape from the city. Beach day perfection! üèñÔ∏èüíô'
      },
      {
        image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Pondicherry üå¥ French vibes, beautiful promenades, and cafe hopping! Our coastal adventure was everything! ‚òïüíï'
      },
      {
        image: 'https://images.unsplash.com/photo-1525625293386-3f8f99389edd?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Kerala üåø Backwaters, boat rides, and lush greenery! Our Kerala trip was a dream come true. So many memories! üö§üíö'
      },
      {
        image: 'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?auto=format&fit=crop&w=900&q=80',
        username: 'Birthday Girl',
        avatar: 'üéÇ',
        caption: 'Movie Theaters üé¨ Countless movie nights, shared popcorn, and discussing plots! Our cinema adventures are the best! üçøüé•'
      }
    ];

    function renderMemories() {
      const feed = document.getElementById('memoryFeed');
      feed.innerHTML = '';
      
      memoriesData.forEach((memory, index) => {
        const post = document.createElement('div');
        post.className = 'instagram-post';
        post.innerHTML = `
          <div class="post-header">
            <div class="post-avatar">${memory.avatar || 'üéÇ'}</div>
            <div>
              <div class="post-username">${memory.username || 'Birthday Girl'}</div>
            </div>
          </div>
          <div class="post-image-container" data-image="${memory.image}" data-index="${index}">
            <img src="${memory.image}" alt="Memory ${index + 1}" loading="lazy" />
          </div>
          <div class="post-actions">
            <button class="post-action-btn" title="Like">‚ù§Ô∏è</button>
            <button class="post-action-btn" title="Comment">üí¨</button>
            <button class="post-action-btn" title="Share">üì§</button>
          </div>
          <div class="post-caption">
            <strong>${memory.username || 'Birthday Girl'}</strong> ${memory.caption || ''}
          </div>
        `;
        feed.appendChild(post);
      });

      // Add click handlers for images
      document.querySelectorAll('.post-image-container').forEach(container => {
        container.style.cursor = 'pointer';
        container.addEventListener('click', () => {
          const image = container.dataset.image;
          openLightbox(image, 'image');
        });
      });
    }

    // Add Memory Modal
    const addMemoryBtn = document.getElementById('addMemoryBtn');
    const addMemoryModal = document.getElementById('addMemoryModal');
    const addMemoryForm = document.getElementById('addMemoryForm');
    const closeAddMemoryModal = document.getElementById('closeAddMemoryModal');

    addMemoryBtn.addEventListener('click', () => {
      addMemoryModal.style.display = 'flex';
      requestAnimationFrame(() => {
        addMemoryModal.classList.add('active');
      });
    });

    closeAddMemoryModal.addEventListener('click', () => {
      addMemoryModal.classList.remove('active');
      setTimeout(() => {
        addMemoryModal.style.display = 'none';
        addMemoryForm.reset();
        imagePreview.style.display = 'none';
        selectedImageDataUrl = null;
      }, 300);
    });

    addMemoryModal.addEventListener('click', (e) => {
      if (e.target === addMemoryModal) {
        addMemoryModal.classList.remove('active');
        setTimeout(() => {
          addMemoryModal.style.display = 'none';
          addMemoryForm.reset();
          imagePreview.style.display = 'none';
          selectedImageDataUrl = null;
        }, 300);
      }
    });

    // Image file upload handler
    const memoryImageFile = document.getElementById('memoryImageFile');
    const imagePreview = document.getElementById('imagePreview');
    const previewImg = document.getElementById('previewImg');
    let selectedImageDataUrl = null;

    memoryImageFile.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        // Clear URL input when file is selected
        document.getElementById('memoryImageUrl').value = '';
        
        const reader = new FileReader();
        reader.onload = (e) => {
          selectedImageDataUrl = e.target.result;
          previewImg.src = selectedImageDataUrl;
          imagePreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        imagePreview.style.display = 'none';
        selectedImageDataUrl = null;
      }
    });

    // URL input handler - clear file when URL is entered
    document.getElementById('memoryImageUrl').addEventListener('input', (e) => {
      if (e.target.value.trim()) {
        memoryImageFile.value = '';
        imagePreview.style.display = 'none';
        selectedImageDataUrl = null;
      }
    });

    addMemoryForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      let imageUrl = document.getElementById('memoryImageUrl').value.trim();
      const username = document.getElementById('memoryUsername').value.trim() || 'Birthday Girl';
      const caption = document.getElementById('memoryCaption').value.trim();

      // Use file data URL if file was selected, otherwise use URL
      if (selectedImageDataUrl) {
        imageUrl = selectedImageDataUrl;
      }

      if (imageUrl && caption) {
        // Add new memory to the array
        memoriesData.unshift({
          image: imageUrl,
          username: username,
          avatar: 'üéÇ',
          caption: caption
        });

        // Re-render memories
        renderMemories();

        // Close modal
        addMemoryModal.classList.remove('active');
        setTimeout(() => {
          addMemoryModal.style.display = 'none';
          addMemoryForm.reset();
          imagePreview.style.display = 'none';
          selectedImageDataUrl = null;
          
          // Scroll to top to see new post
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 300);

        // Show success message
        const successMsg = document.createElement('div');
        successMsg.textContent = '‚ú® Memory added successfully!';
        successMsg.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: var(--gradient);
          padding: 1.5rem 2.5rem;
          border-radius: 25px;
          font-size: 1.2rem;
          font-weight: bold;
          color: #5d2e75;
          z-index: 2000;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
          animation: popIn 0.5s ease-out;
        `;
        document.body.appendChild(successMsg);
        setTimeout(() => {
          successMsg.style.animation = 'popOut 0.5s ease-in forwards';
          setTimeout(() => successMsg.remove(), 500);
        }, 2000);
      }
    });

    // Initialize memory feed when page loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        if (typeof renderMemories === 'function') {
          renderMemories();
        }
      });
    } else {
      // DOM already loaded
      if (typeof renderMemories === 'function') {
        renderMemories();
      }
    }

    // Override showPage to render memories when memories page is shown
    const originalShowPageFunction = window.showPage;
    window.showPage = function(pageId) {
      // Call original function first
      if (originalShowPageFunction) {
        originalShowPageFunction(pageId);
      }
      
      // Re-render memories when memories page is shown
      if (pageId === 'memories') {
        setTimeout(() => {
          if (typeof renderMemories === 'function') {
            renderMemories();
          }
        }, 100);
      }
    };

    // Old memory card click handlers (removed - now using new system)

    document.getElementById('closeLightbox').addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        closeLightbox();
      }
    });

    // ESC key to close lightbox
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && lightbox.style.display === 'flex') {
        closeLightbox();
      }
    });

    // Flap toggle
    document.querySelectorAll('.flap-card').forEach(flap => {
      flap.addEventListener('click', () => flap.classList.toggle('open'));
    });

    // Wish modal styling
    const wishModalStyle = document.createElement('style');
    wishModalStyle.innerHTML = `
      #wishModal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(36, 17, 52, 0.88);
        -webkit-backdrop-filter: blur(8px);
        backdrop-filter: blur(8px);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      #wishModal.active {
        display: flex;
        opacity: 1;
      }
      #wishModalContent {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 30px;
        padding: 2.5rem;
        max-width: 500px;
        width: 100%;
        box-shadow: 0 30px 60px rgba(0,0,0,0.5), 0 0 40px rgba(255,154,200,0.3);
        transform: scale(0.9);
        transition: transform 0.3s ease;
      }
      #wishModal.active #wishModalContent {
        transform: scale(1);
      }
      #wishForm textarea {
        width: 100%;
        min-height: 150px;
        padding: 1rem;
        border-radius: 18px;
        border: 2px solid rgba(255, 154, 200, 0.3);
        font-size: 1rem;
        font-family: inherit;
        resize: vertical;
        margin-bottom: 1rem;
      }
      #wishForm textarea:focus {
        outline: none;
        border-color: var(--pink);
        box-shadow: 0 0 0 3px rgba(255, 154, 200, 0.2);
      }
    `;
    document.head.appendChild(wishModalStyle);

    // Cake interaction with wish form
    const cake = document.getElementById('birthdayCake');
    const cakeMessage = document.getElementById('cakeMessage');
    let wishModal = null;
    
    cake.addEventListener('click', () => {
      const isLit = cake.getAttribute('data-lit') === 'true';
      cake.setAttribute('data-lit', !isLit);
      
      // Add sparkle effect when blowing out
      if (isLit) {
        const rect = cake.getBoundingClientRect();
        for (let i = 0; i < 15; i++) {
          setTimeout(() => {
            createSparkle(
              rect.left + rect.width / 2 + (Math.random() - 0.5) * 60,
              rect.top + (Math.random() - 0.5) * 40
            );
          }, i * 50);
        }
        // Trigger confetti burst
        setTimeout(() => launchCelebration(), 200);
        
        // Show wish form after a short delay
        setTimeout(() => {
          showWishModal();
        }, 1500);
      }
      
      cakeMessage.textContent = isLit ? 'üéâ Wish granted! Candles out and dreams soaring. üéâ' : '‚ú® Candles relit! You get another wish. ‚ú®';
    });

    function showWishModal() {
      if (!wishModal) {
        wishModal = document.createElement('div');
        wishModal.id = 'wishModal';
        wishModal.innerHTML = `
          <div id="wishModalContent">
            <h3 style="text-align: center; color: #6d2d7c; margin-bottom: 1.5rem; font-size: 1.8rem;">‚ú® Type Your Wish ‚ú®</h3>
            <form id="wishForm">
              <textarea id="wishMessage" placeholder="Make a wish and it will be sent to me... üåü" required></textarea>
              <div style="display: flex; gap: 1rem;">
                <button type="submit" class="btn" style="flex: 1;">Send Wish üíå</button>
                <button type="button" class="btn" id="closeWishModal" style="flex: 1; background: rgba(255, 255, 255, 0.9); color: #6d2d7c;">Cancel</button>
              </div>
            </form>
          </div>
        `;
        document.body.appendChild(wishModal);
        
        document.getElementById('wishForm').addEventListener('submit', (e) => {
          e.preventDefault();
          const wish = document.getElementById('wishMessage').value.trim();
          if (wish) {
            sendWishEmail(wish);
            wishModal.classList.remove('active');
            setTimeout(() => {
              wishModal.style.display = 'none';
              document.getElementById('wishForm').reset();
            }, 300);
          }
        });
        
        document.getElementById('closeWishModal').addEventListener('click', () => {
          wishModal.classList.remove('active');
          setTimeout(() => {
            wishModal.style.display = 'none';
            document.getElementById('wishForm').reset();
          }, 300);
        });
        
        wishModal.addEventListener('click', (e) => {
          if (e.target === wishModal) {
            wishModal.classList.remove('active');
            setTimeout(() => {
              wishModal.style.display = 'none';
              document.getElementById('wishForm').reset();
            }, 300);
          }
        });
      }
      
      wishModal.style.display = 'flex';
      requestAnimationFrame(() => {
        wishModal.classList.add('active');
        document.getElementById('wishMessage').focus();
      });
    }

    function sendWishEmail(wish) {
      const email = 'balag31072002@gmail.com';
      const subject = encodeURIComponent('Birthday Wish from Scrapbook! üéÇ‚ú®');
      const body = encodeURIComponent(`A special birthday wish:\n\n${wish}\n\n- Sent from the Birthday Scrapbook üéâ`);
      const mailtoLink = `mailto:${email}?subject=${subject}&body=${body}`;
      
      // Try to open email client
      window.location.href = mailtoLink;
      
      // Show success message
      const successMsg = document.createElement('div');
      successMsg.textContent = 'üíå Wish sent! Check your email client or copy the link.';
      successMsg.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--gradient);
        padding: 1.5rem 2.5rem;
        border-radius: 25px;
        font-size: 1.2rem;
        font-weight: bold;
        color: #5d2e75;
        z-index: 2000;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        animation: popIn 0.5s ease-out;
      `;
      document.body.appendChild(successMsg);
      setTimeout(() => {
        successMsg.style.animation = 'popOut 0.5s ease-in forwards';
        setTimeout(() => successMsg.remove(), 500);
      }, 3000);
    }

    // Spin wheel
    const wheel = document.getElementById('wishWheel');
    const wheelResult = document.getElementById('wheelResult');
    const wishes = [
      'New food',
      'Shopping',
      'Movie with me',
      'A full day with me I plan everything',
      'Truth or dare with me',
      'A dance reel with me'
    ];
    document.getElementById('spinWheelBtn').addEventListener('click', () => {
      const spin = 360 * 5 + Math.floor(Math.random() * 360);
      wheel.style.transform = `rotate(${spin}deg)`;
      const wishIndex = Math.floor(Math.random() * wishes.length);
      const wish = wishes[wishIndex];
      setTimeout(() => {
        wheelResult.textContent = wish;
      }, 4200);
    });

    // Pull tabs
    document.querySelectorAll('.pull-tab').forEach(tab => {
      tab.querySelector('.pull-btn').addEventListener('click', () => tab.classList.toggle('open'));
    });

    // Guestbook removed - replaced with surprise section

    // Audio control
    const audio = document.getElementById('birthdayAudio');
    const audioToggle = document.getElementById('audioToggle');
    audioToggle.addEventListener('click', () => {
      if (audio.paused) {
        audio.play();
        audioToggle.textContent = 'Mute Music ';
      } else {
        audio.pause();
        audioToggle.textContent = 'Play Music ';
      }
    });

    // Celebration confetti mode
    const canvas = document.getElementById('celebrationCanvas');
    const ctx = canvas.getContext('2d');
    const celebrationBtn = document.getElementById('celebrationBtn');
    let confettiPieces = [];
    let animationId = null;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function launchCelebration() {
      if (animationId) {
        cancelAnimationFrame(animationId);
      }
      
      canvas.style.opacity = 1;
      confettiPieces = Array.from({ length: 250 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * -canvas.height,
        r: Math.random() * 8 + 4,
        d: Math.random() * 50 + 50,
        tilt: Math.random() * 10,
        tiltSpeed: (Math.random() - 0.5) * 0.2,
        vy: Math.random() * 3 + 2,
        vx: (Math.random() - 0.5) * 2,
        color: `hsl(${Math.random()*360},80%,70%)`
      }));
      
      audio.play().catch(() => {});
      renderConfetti();
      setTimeout(() => { 
        canvas.style.opacity = 0;
        if (animationId) {
          cancelAnimationFrame(animationId);
          animationId = null;
        }
      }, 8000);
    }

    function renderConfetti() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      let activePieces = 0;
      
      confettiPieces.forEach(p => {
        ctx.fillStyle = p.color;
        ctx.shadowBlur = 10;
        ctx.shadowColor = p.color;
        ctx.beginPath();
        ctx.ellipse(p.x, p.y, p.r, p.r/2, p.tilt, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
        
        p.y += p.vy;
        p.x += p.vx;
        p.tilt += p.tiltSpeed;
        p.vy += 0.1; // gravity
        
        if (p.y < canvas.height + 50) {
          activePieces++;
        } else {
          p.y = -10;
          p.x = Math.random() * canvas.width;
        }
      });
      
      if (canvas.style.opacity > 0 && activePieces > 0) {
        animationId = requestAnimationFrame(renderConfetti);
      }
    }

    celebrationBtn.addEventListener('click', () => {
      launchCelebration();
      // Add extra sparkles on button click
      const rect = celebrationBtn.getBoundingClientRect();
      for (let i = 0; i < 20; i++) {
        setTimeout(() => {
          createSparkle(
            rect.left + Math.random() * rect.width,
            rect.top + Math.random() * rect.height
          );
        }, i * 30);
      }
    });

    // Celebration sounds (soft star chime)
    const starSound = new Audio('https://cdn.pixabay.com/download/audio/2022/03/15/audio_f183f1cdd9.mp3?filename=magical-chime-113425.mp3');
    starSound.volume = 0.5;
    
    const originalCelebrationClick = celebrationBtn.onclick;
    celebrationBtn.addEventListener('click', () => {
      starSound.play().catch(() => {});
    });

    // Remove old smooth scrolling for anchor links (now handled by page system)
  </script>
</body>
</html>
